# TipOut

## 页面关系

- **小费分配规则** → **小费分配** → **小费分配明细**
- 需先在小费分配规则中创建规则，才能在小费分配页面执行「分配小费」
- 分配成功后，小费分配明细页才会展示该日期、该门店的分配明细
- 未创建规则或未完成分配时，对应页面会提示并引导用户完成前置步骤

## 1. 小费分配

### 1.1 筛选条件

- **日期选择器**
  - 年月日
  - 时间段
- **门店名称**
  - 单选
- **角色（单选）**
  - Assistant Manager
  - Bartender
  - Boss
  - Busser
  - Cashier
  - Driver
  - Host
  - Manager
  - Runner
  - Server
  - Shift Lead
  - Trainee
  - Waiter
- **员工（多选）**
  - abner asencio
  - acacia fields
  - ace nguyen
  - adam ace
  - antonio arana
  - aria heydrick
  - ashley young
  - atalie luong
  - audrey lin

### 1.2 时间段

- 时间段内的每天
- **分配状态**
  - 已分配
  - 待分配
- **按钮**
  - 重新分配小费

### 1.3 分配结果

- 员工姓名
- 员工角色
- **员工小费分配前后总结果**
  - 分配前总小费
  - 被分配总小费
  - 分配后总小费
- **员工小费分配时间段内每天的结果**
  - 分配前小费
  - 被分配小费
  - 分配后小费
- **按钮**
  - 导出结果（Excel表格）

---

## 2. 小费分配明细

### 2.1 筛选条件

- **日期选择器**
  - 年月日
  - 时间点
- **门店名称**
  - 单选

### 2.2 明细列表

#### 2.2.1 公式

- 根据小费分配规则中的小费池公式动态展示
- **示例**
  - 小费池总金额 = 销售额 × 占比 + 自定义小费 × 占比
  - 小费池总金额 = 销售额 × 占比 + 小费 × 占比 + 自定义小费 × 占比
  - 小费池总金额 = 销售额 × 占比 + 小费 × 占比 + 手动上报小费 × 占比 + 自定义小费 × 占比
- **按钮**
  - 公式详情 —— 点击公式详情，展示小费分配规则

#### 2.2.2 明细详情

- **角色**
- **角色分配比例**
  - 百分比
  - 可修改
- **角色分配金额**
  - 根据角色分配比例计算结果
- **分配员工**
  - 单选
- **员工分配比例**
  - 百分比
  - 可修改
- **员工分配金额**
  - 根据员工分配比例计算结果
- **操作**
  - 删除行
  - 新增行

### 2.3 按钮

- 取消
- 保存
- 保存并跳转到下一天

---

## 3. 小费分配规则

### 3.1 筛选条件（多选）

- 门店

### 3.2 规则列表

- 门店名称
- 规则名称
- **操作**
  - 编辑
  - 删除
  - 复制

### 3.3 新增规则

#### 3.3.1 规则名称

#### 3.3.2 门店（单选）

#### 3.3.3 小费池计算规则

##### 销售额

- **占比**
  - 百分比
  - 可输入
- **设置取值条件**
 - **角色（多选）** —— 根据 POS 中的角色动态获取
    - Busser
    - Cashier
    - Driver
    - Host
  - **订单区域** —— 根据 POS 中的区域动态获取
    - 区域A
    - 区域B
  - **订单类型** —— 根据 POS 中的订单类型动态获取
    - Dine In
    - Delivery
    - Pick Up
    - To Go
  - **菜单** —— 按照产品线
    - 组
    - 类
  - **营业额类型**
    - 税前营业额
    - 总销售额
  - **营业时间**
    - 时间段（时分，24小时制）
  - **按钮**
    - 取消 —— 点击取消，关闭取值条件
    - 提交 —— 点击提交，保存取值条件
- **按钮**
  - 删除 —— 点击删除，删除该规则

##### 小费

- **占比**
  - 百分比
  - 可输入
- **设置取值条件**
  - **订单区域** —— 根据 POS 中的区域动态获取
    - 区域A
    - 区域B
  - **订单类型** —— 根据 POS 中的订单类型动态获取
    - Dine In
    - Delivery
    - Pick Up
    - To Go
  - **营业时间**
    - 时间段（时分，24小时制）
    - 示例：00:00-11:00、00:00-13:00
  - **小费类型**
    - 所有小费
    -现金小费
    -信用卡小费
    -其他小费
  - **按钮**
    - 取消 —— 点击取消，关闭取值条件
    - 提交 —— 点击提交，保存取值条件
- **按钮**
  - 删除 —— 点击删除，删除该规则

##### 手动上报小费

- **占比**
  - 百分比
  - 可输入
- **按钮**
  - 删除 —— 点击删除，删除该规则

##### 自定义小费

- **按钮**
  - 删除 —— 点击删除，删除该规则

##### 新增选项

- 销售额
- 小费
- 手动上报小费
- 自定义小费
- 已经新增的选择不在选项列表中展示

#### 3.3.4 扣除方规则

- **按照角色选择**（角色支持多选）
  - Bartender
  - Busser
  - Cashier、Server

#### 3.3.5 接收方规则

##### 角色

- 角色支持多选
  - Bartender
  - Busser
  - Cashier、Server
- 可设置小费池贡献百分比
- 可添加多个角色占比规则
  - **示例**
    - Bartender —— 设置从小费池分配到 10%
    - Busser —— 设置从小费池分配到 20%
    - Cashier、Server —— 设置从小费池分配到 70%

##### 分配方式（单选）

- 按员工数量平均分配
- 按工作时长占比分配
- 按订单占比分配

##### 员工打卡方式（单选）

- 打卡上班
- 不打卡

##### 员工权重

- **设置**
  - **角色** —— 从接收方规则中选择的角色进行获取
  - **员工姓名** —— 从接收方规则中选择的角色中包含的员工进行获取
  - **员工权重**
    - 大于等于 0
    - 可自定义
  - **按钮**
    - 取消
    - 确定
- **不设置**

#### 3.3.6 按钮

- 取消 —— 点击取消，取消小费分配规则的创建
- 提交 —— 点击提交，保存小费分配规则的创建
